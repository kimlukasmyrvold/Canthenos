@using Canthenos.DataAccessLibrary.Models
@using Canthenos.DataAccessLibrary

@inject IDishesData Db


<div class="products">
    <div class="products__container">
        <div class="products__container__aside">
            <p class="products__container__aside__title">Dishes</p>
            <div class="products__container__aside__options">
                <div class="products__container__aside__options__sort_by">
                    <Dropdown Placeholder="Sort By" Options="_sortByOptions" Chosen="@SortyByOption"></Dropdown>
                </div>
            </div>
        </div>
        <div class="products__container__content">
            @if (_dishes is null)
            {
                <p>
                    <em>Loading...</em>
                </p>
            }
            else
            {
                foreach (var dish in _dishes)
                {
                    <Product Type="Dish" Image="@dish.ImagePath" Name="@dish.Name" Description="@dish.Description" Allergies="" Price="@dish.Price"></Product>
                }
            }
        </div>

    </div>
</div>


@code {

    private List<DishesModel>? _dishes;

    protected override async Task OnInitializedAsync()
    {
        _dishes = await Db.GetDishes();
    }

    private readonly Dictionary<int, string> _sortByOptions = new()
    {
        { 0, "Popularity" },
        { 1, "Price (Low to High)" },
        { 2, "Price (High to Low)" },
        { 3, "Name (A to Z)" },
        { 4, "Name (Z to A)" }
    };

    private int _sortBySelected;

    private async Task SortyByOption(int option)
    {
        _sortBySelected = option;
        _dishes = await Db.GetDishes(_sortBySelected);
    }

}